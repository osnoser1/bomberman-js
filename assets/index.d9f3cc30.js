var ie=Object.defineProperty,re=Object.defineProperties;var oe=Object.getOwnPropertyDescriptors;var k=Object.getOwnPropertySymbols;var ae=Object.prototype.hasOwnProperty,ne=Object.prototype.propertyIsEnumerable;var A=(s,e,t)=>e in s?ie(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,B=(s,e)=>{for(var t in e||(e={}))ae.call(e,t)&&A(s,t,e[t]);if(k)for(var t of k(e))ne.call(e,t)&&A(s,t,e[t]);return s},I=(s,e)=>re(s,oe(e));var n=(s,e,t)=>(A(s,typeof e!="symbol"?e+"":e,t),t),j=(s,e,t)=>{if(!e.has(s))throw TypeError("Cannot "+t)};var h=(s,e,t)=>(j(s,e,"read from private field"),t?t.call(s):e.get(s)),d=(s,e,t)=>{if(e.has(s))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(s):e.set(s,t)},l=(s,e,t,r)=>(j(s,e,"write to private field"),r?r.call(s,t):e.set(s,t),t);var $=(s,e,t)=>(j(s,e,"access private method"),t);import{i as he,r as b,p as Z}from"./vendor.04f3e4dd.js";const pe=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}};pe();var u=(s=>(s[s.BALLOOM=0]="BALLOOM",s[s.ONEAL=1]="ONEAL",s[s.DOLL=2]="DOLL",s[s.MINVO=3]="MINVO",s[s.KONDORIA=4]="KONDORIA",s[s.OVAPI=5]="OVAPI",s[s.PASS=6]="PASS",s[s.PONTAN=7]="PONTAN",s[s.Length=8]="Length",s))(u||{});const R={};function g(s){return e=>{le(I(B({},s),{enemyClass:e}))}}function le(s){if(he(s.type))throw new TypeError("config.type is required");if(R[s.type])throw new Error(`The enemy with the name "${s.enemyClass.name}" has already exists, please try another name!`);R[s.type]=s.enemyClass}function ce(s){return R[s]}const H=0,L=1,E=Number.EPSILON;var m,y,v,_,x;const c=class{constructor(){d(this,_);d(this,m,void 0);d(this,y,void 0);d(this,v,void 0);l(this,m,$(this,_,x).call(this,H,L)),l(this,y,[]),l(this,v,[])}get emptyMap(){return $(this,_,x).call(this,H,L)}get value(){return h(this,m)}randomBricks(){l(this,m,$(this,_,x).call(this,H,L)),l(this,y,[]);for(let e=0;e<c.BrickCount;e++)do{let t=b(c.Columns-2),r=b(c.Rows-2);if(!(t<3&&r==1||t==1&&r<3)&&h(this,m)[r][t]===L){h(this,y).push({x:t,y:r}),h(this,m)[r][t]=E;break}}while(!0);return h(this,y)}randomEnemies(){l(this,v,[]);for(let e=0;e<c.EnemiesCount;e++)do{let t=b(c.Columns-2),r=b(c.Rows-2),i=b(u.Length-1);if(h(this,m)[r][t]===L){h(this,v).push({x:t,y:r,type:i}),h(this,m)[r][t]=E;break}}while(!0);return h(this,v)}};let f=c;m=new WeakMap,y=new WeakMap,v=new WeakMap,_=new WeakSet,x=function(e,t){const r=[];for(let i=0;i<c.Rows;i++){r.push([]);for(let o=0;o<c.Columns;o++){const a=i%2!=1&&o%2!=1||i==0||i==12||o==0||o==30?e:t;r[i].push(a)}}return r},n(f,"Columns",31),n(f,"Rows",13),n(f,"BrickCount",55),n(f,"EnemiesCount",10);const me=Phaser.Scale.ScaleModes,ue=Phaser.Scale.Center,F=40,X=40,p={scale:{width:640,height:520},graphics:{tileWidth:F,tileHeight:X,sceneWidth:f.Columns*F,sceneHeight:f.Rows*X}},de={type:Phaser.AUTO,fps:{target:60},pixelArt:!0,scale:{width:p.scale.width,height:p.scale.height,mode:me.FIT,autoCenter:ue.CENTER_BOTH},physics:{default:"arcade",arcade:{debug:!0}}};function fe(s,e){return{x:Math.trunc(s/p.graphics.tileWidth),y:Math.trunc(e/p.graphics.tileHeight)}}const be=(s,e)=>t=>s*e+t;function ge(s,e,t,r,i){e.forEach(o=>{t.create({key:o.key,frames:t.generateFrameNumbers(s,{frames:o.frames.map(be(o.row,r))}),frameRate:i,repeat:-1})})}class M{constructor(e,t,r,i,o,a,N,S=!1){n(this,"movementType");n(this,"movement");this.name=e,this.sprite=t,this.sprite.setOrigin(0,0),this.sprite.setPosition(r*p.graphics.tileWidth,i*p.graphics.tileHeight),this.sprite.setImmovable(S),this.sprite.setScale(2.5),ge(this.name,o,this.sprite.anims,a,N),this.sprite.anims.play("initial")}}const we=8;class ye extends M{constructor(t,r,i,o){const a=t.physics.add.sprite(0,0,"bomberman");super("bomberman",a,i,o,[{key:"initial",row:0,frames:[0]},{key:"up",row:1,frames:[2,1,0,1]},{key:"down",row:2,frames:[2,1,0,1]},{key:"right",row:3,frames:[2,1,0,1]},{key:"left",row:4,frames:[2,1,0,1]},{key:"death",row:5,frames:[0,1,2,3,4]}],6,we);n(this,"speed",240);this.bombs=r,this.sprite.setDepth(1)}update(t,r,i,o,a,N){i.right.isDown?this.sprite.anims.play("right",!0):i.left.isDown?this.sprite.anims.play("left",!0):i.up.isDown?this.sprite.anims.play("up",!0):i.down.isDown&&this.sprite.anims.play("down",!0),!i.right.isDown&&!i.left.isDown&&!i.up.isDown&&!i.down.isDown&&this.sprite.anims.pause(),i.up.isDown?this.sprite.setVelocityY(-this.speed):i.down.isDown?this.sprite.setVelocityY(this.speed):this.sprite.setVelocityY(0),i.right.isDown?this.sprite.setVelocityX(this.speed):i.left.isDown?this.sprite.setVelocityX(-this.speed):this.sprite.setVelocityX(0);const S=o.keyboard.addKey("C");if(o.keyboard.checkDown(S)&&!a.overlap(this.sprite,this.bombs.group)&&!a.overlap(this.sprite,N.bricks.group)){const W=this.sprite.getCenter(),{x:te,y:se}=fe(W.x,W.y);this.bombs.addBomb(te,se)}}}const ve=3;class Oe extends M{constructor(e,t,r){super("bomb",e.get(),t,r,[{key:"initial",row:0,frames:[0,1,2]}],6,ve,!0)}}class Pe{constructor(e){n(this,"group");this.group=e.physics.add.group({defaultKey:"bomb"})}addBomb(e,t){new Oe(this.group,e,t)}}const De=3;class _e extends M{constructor(e,t,r){super("brick",e.get(),t,r,[{key:"initial",row:0,frames:[0]},{key:"dead",row:5,frames:[0,1,2]}],6,De,!0)}}class Le{constructor(e){n(this,"group");this.group=e.physics.add.group({defaultKey:"brick"})}generateRandom(e){e.randomBricks().forEach(r=>new _e(this.group,r.x,r.y))}}var ee=(s=>(s[s.Low=0]="Low",s[s.Mid=1]="Mid",s[s.High=2]="High",s[s.Impossible=3]="Impossible",s))(ee||{}),O,C;class Ce{constructor(e){d(this,O,void 0);d(this,C,void 0);if(l(this,O,e),h(this,O).movementType===3)throw new Error("Impossible movement type hasn't been implemented")}start(){l(this,C,setInterval(()=>{h(this,O).movementType===0?this.makeMovement(b(0,3)):this.makeMovement(b(0,1),b(2,3))},2e3))}stop(){clearInterval(h(this,C))}makeMovement(e,t){let r=0,i=0;e===0?r=-1:e===1&&(r=1),e===2||t===2?i=-1:(e===3||t===3)&&(i=1),h(this,O).sprite.setVelocity(r*32,i*32)}}O=new WeakMap,C=new WeakMap;const $e=8;class w extends M{constructor(e,t,r,i){super(e,t,r,i,[{key:"initial",row:1,frames:[0]},{key:"up",row:1,frames:[0,1,2]},{key:"down",row:2,frames:[0,1,2]},{key:"right",row:3,frames:[0,1,2]},{key:"left",row:4,frames:[0,1,2]},{key:"death",row:5,frames:[0,1,2,3]}],5,$e),this.sprite.setDepth(1),this.sprite.setBounce(1,1),this.movementType=ee.High,this.movement=new Ce(this)}}var xe=Object.defineProperty,Me=Object.getOwnPropertyDescriptor,Ne=(s,e,t,r)=>{for(var i=r>1?void 0:r?Me(e,t):e,o=s.length-1,a;o>=0;o--)(a=s[o])&&(i=(r?a(e,t,i):a(i))||i);return r&&i&&xe(e,t,i),i};let Y=class extends w{constructor(e,t,r){super("balloom",e.get(),t,r);n(this,"speed",120);this.sprite.setDepth(1)}};Y=Ne([g({type:u.BALLOOM})],Y);var Se=Object.defineProperty,Ae=Object.getOwnPropertyDescriptor,Be=(s,e,t,r)=>{for(var i=r>1?void 0:r?Ae(e,t):e,o=s.length-1,a;o>=0;o--)(a=s[o])&&(i=(r?a(e,t,i):a(i))||i);return r&&i&&Se(e,t,i),i};let G=class extends w{constructor(e,t,r){super("doll",e.get(),t,r);n(this,"speed",120);this.sprite.setDepth(1)}};G=Be([g({type:u.DOLL})],G);var Ie=Object.defineProperty,je=Object.getOwnPropertyDescriptor,He=(s,e,t,r)=>{for(var i=r>1?void 0:r?je(e,t):e,o=s.length-1,a;o>=0;o--)(a=s[o])&&(i=(r?a(e,t,i):a(i))||i);return r&&i&&Ie(e,t,i),i};let q=class extends w{constructor(e,t,r){super("kondoria",e.get(),t,r);n(this,"speed",120);this.sprite.setDepth(1)}};q=He([g({type:u.KONDORIA})],q);var Ve=Object.defineProperty,Ke=Object.getOwnPropertyDescriptor,Re=(s,e,t,r)=>{for(var i=r>1?void 0:r?Ke(e,t):e,o=s.length-1,a;o>=0;o--)(a=s[o])&&(i=(r?a(e,t,i):a(i))||i);return r&&i&&Ve(e,t,i),i};let U=class extends w{constructor(e,t,r){super("minvo",e.get(),t,r);n(this,"speed",120);this.sprite.setDepth(1)}};U=Re([g({type:u.MINVO})],U);var We=Object.defineProperty,ke=Object.getOwnPropertyDescriptor,Ee=(s,e,t,r)=>{for(var i=r>1?void 0:r?ke(e,t):e,o=s.length-1,a;o>=0;o--)(a=s[o])&&(i=(r?a(e,t,i):a(i))||i);return r&&i&&We(e,t,i),i};let z=class extends w{constructor(e,t,r){super("oneal",e.get(),t,r);n(this,"speed",120);this.sprite.setDepth(1)}};z=Ee([g({type:u.ONEAL})],z);var Fe=Object.defineProperty,Xe=Object.getOwnPropertyDescriptor,Ye=(s,e,t,r)=>{for(var i=r>1?void 0:r?Xe(e,t):e,o=s.length-1,a;o>=0;o--)(a=s[o])&&(i=(r?a(e,t,i):a(i))||i);return r&&i&&Fe(e,t,i),i};let J=class extends w{constructor(e,t,r){super("ovapi",e.get(),t,r);n(this,"speed",120);this.sprite.setDepth(1)}};J=Ye([g({type:u.OVAPI})],J);var Ge=Object.defineProperty,qe=Object.getOwnPropertyDescriptor,Ue=(s,e,t,r)=>{for(var i=r>1?void 0:r?qe(e,t):e,o=s.length-1,a;o>=0;o--)(a=s[o])&&(i=(r?a(e,t,i):a(i))||i);return r&&i&&Ge(e,t,i),i};let Q=class extends w{constructor(e,t,r){super("pass",e.get(),t,r);n(this,"speed",120);this.sprite.setDepth(1)}};Q=Ue([g({type:u.PASS})],Q);var ze=Object.defineProperty,Je=Object.getOwnPropertyDescriptor,Qe=(s,e,t,r)=>{for(var i=r>1?void 0:r?Je(e,t):e,o=s.length-1,a;o>=0;o--)(a=s[o])&&(i=(r?a(e,t,i):a(i))||i);return r&&i&&ze(e,t,i),i};let T=class extends w{constructor(e,t,r){super("pontan",e.get(),t,r);n(this,"speed",120);this.sprite.setDepth(1)}};T=Qe([g({type:u.PONTAN})],T);class Te{constructor(e){n(this,"group");this.group=e.physics.add.group({defaultKey:"brick"})}generateRandom(e){e.randomEnemies().forEach(r=>{var a;const i=ce(r.type);(a=new i(this.group,r.x,r.y).movement)==null||a.start()})}}var P,D;class Ze{constructor(e){n(this,"itemTileSetLayer");d(this,P,void 0);d(this,D,void 0);n(this,"bricks");n(this,"enemies");l(this,P,new f),l(this,D,e.make.tilemap({data:h(this,P).emptyMap,width:p.graphics.sceneWidth,height:p.graphics.sceneHeight,tileWidth:p.graphics.tileWidth,tileHeight:p.graphics.tileHeight}));const t=h(this,D).addTilesetImage("items",void 0,16,16);this.itemTileSetLayer=h(this,D).createLayer(0,t),this.bricks=new Le(e),this.enemies=new Te(e),h(this,D).setCollision(0)}reset(){this.bricks.generateRandom(h(this,P)),this.enemies.generateRandom(h(this,P))}update(e,t){}}P=new WeakMap,D=new WeakMap;const V=16,K=16;class et extends Z.exports.Scene{constructor(){super("GameScene");n(this,"cursors");n(this,"bomberman");n(this,"bombs");n(this,"tileMap")}preload(){this.load.image("items","assets/map/items.png"),this.load.spritesheet("brick","assets/map/brick.png",{frameWidth:V,frameHeight:K}),this.load.spritesheet("bomb","assets/map/bomb.png",{frameWidth:V,frameHeight:K}),["bomberman","balloom","doll","kondoria","minvo","oneal","ovapi","pass","pontan"].forEach(t=>this.load.spritesheet(t,`assets/players/${t}.png`,{frameWidth:V,frameHeight:K}))}create(){this.cursors=this.input.keyboard.createCursorKeys(),this.tileMap=new Ze(this),this.tileMap.reset(),this.cameras.main.setBounds(0,0,p.graphics.sceneWidth,p.graphics.sceneHeight),this.physics.world.setBounds(0,0,p.graphics.sceneWidth,p.graphics.sceneHeight),this.bombs=new Pe(this),this.bomberman=new ye(this,this.bombs,1,1),this.physics.add.collider(this.bomberman.sprite,this.tileMap.itemTileSetLayer),this.physics.add.collider(this.bombs.group,this.tileMap.itemTileSetLayer),this.physics.add.collider(this.bombs.group,this.bombs.group),this.physics.add.collider(this.bomberman.sprite,this.bombs.group),this.physics.add.collider(this.tileMap.enemies.group,[this.bombs.group,this.tileMap.bricks.group]),this.physics.add.collider(this.tileMap.enemies.group,this.tileMap.itemTileSetLayer),this.cameras.main.startFollow(this.bomberman.sprite,!0)}update(t,r){super.update(t,r),this.bomberman.update(t,r,this.cursors,this.input,this.physics,this.tileMap),this.tileMap.update(t,r)}}new Z.exports.Game(I(B({},de),{scene:[et]}));
