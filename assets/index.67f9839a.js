var Je=Object.defineProperty,Qe=Object.defineProperties;var Ze=Object.getOwnPropertyDescriptors;var Ce=Object.getOwnPropertySymbols;var et=Object.prototype.hasOwnProperty,tt=Object.prototype.propertyIsEnumerable;var de=(s,e,t)=>e in s?Je(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,ie=(s,e)=>{for(var t in e||(e={}))et.call(e,t)&&de(s,t,e[t]);if(Ce)for(var t of Ce(e))tt.call(e,t)&&de(s,t,e[t]);return s},re=(s,e)=>Qe(s,Ze(e));var p=(s,e,t)=>(de(s,typeof e!="symbol"?e+"":e,t),t),ue=(s,e,t)=>{if(!e.has(s))throw TypeError("Cannot "+t)};var l=(s,e,t)=>(ue(s,e,"read from private field"),t?t.call(s):e.get(s)),c=(s,e,t)=>{if(e.has(s))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(s):e.set(s,t)},u=(s,e,t,r)=>(ue(s,e,"write to private field"),r?r.call(s,t):e.set(s,t),t);var b=(s,e,t)=>(ue(s,e,"access private method"),t);import{i as We,r as L,o as st,m as it,a as rt,n as ot,p as Fe}from"./vendor.b8ce2bad.js";const at=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}};at();var D=(s=>(s[s.BALLOOM=0]="BALLOOM",s[s.ONEAL=1]="ONEAL",s[s.DOLL=2]="DOLL",s[s.MINVO=3]="MINVO",s[s.KONDORIA=4]="KONDORIA",s[s.OVAPI=5]="OVAPI",s[s.PASS=6]="PASS",s[s.PONTAN=7]="PONTAN",s[s.Length=8]="Length",s))(D||{});const we={};function A(s){return e=>{nt(re(ie({},s),{enemyClass:e}))}}function nt(s){if(We(s.type))throw new TypeError("config.type is required");if(we[s.type])throw new Error(`The enemy with the name "${s.enemyClass.name}" has already exists, please try another name!`);we[s.type]=s.enemyClass}function lt(s){return we[s]}const fe=0,H=1,ke=Number.EPSILON;var O,I,$,F,ne;const v=class{constructor(){c(this,F);c(this,O,void 0);c(this,I,void 0);c(this,$,void 0);u(this,O,b(this,F,ne).call(this,fe,H)),u(this,I,[]),u(this,$,[])}static isSolidBlock(e,t){return t%2!=1&&e%2!=1||t<=0||t>=12||e<=0||e>=30}get emptyMap(){return b(this,F,ne).call(this,fe,H)}get value(){return l(this,O)}randomBricks(){u(this,O,b(this,F,ne).call(this,fe,H)),u(this,I,[]);for(let e=0;e<v.BrickCount;e++)do{let t=L(v.Columns-2),r=L(v.Rows-2);if(!(t<3&&r==1||t==1&&r<3)&&l(this,O)[r][t]===H){l(this,I).push({x:t,y:r}),l(this,O)[r][t]=ke;break}}while(!0);return l(this,I)}randomEnemies(){u(this,$,[]);for(let e=0;e<v.EnemiesCount;e++)do{let t=L(v.Columns-2),r=L(v.Rows-2),i=L(D.Length-1);if(l(this,O)[r][t]===H){l(this,$).push({x:t,y:r,type:i}),l(this,O)[r][t]=ke;break}}while(!0);return l(this,$)}};let N=v;O=new WeakMap,I=new WeakMap,$=new WeakMap,F=new WeakSet,ne=function(e,t){const r=[];for(let i=0;i<v.Rows;i++){r.push([]);for(let o=0;o<v.Columns;o++){const a=v.isSolidBlock(o,i)?e:t;r[i].push(a)}}return r},p(N,"Columns",31),p(N,"Rows",13),p(N,"BrickCount",55),p(N,"EnemiesCount",10);const pt=Phaser.Scale.ScaleModes,ht=Phaser.Scale.Center,_e=40,Ee=40,d={scale:{width:640,height:520},graphics:{tile:{width:_e,height:Ee},sceneWidth:N.Columns*_e,sceneHeight:N.Rows*Ee}},ct={type:Phaser.AUTO,fps:{target:60},pixelArt:!0,scale:{width:d.scale.width,height:d.scale.height,mode:pt.FIT,autoCenter:ht.CENTER_BOTH},physics:{default:"arcade",arcade:{debug:!0}}},mt=(s,e)=>t=>s*e+t;function Ve(s,e,t,r,i){e.forEach(o=>{var a;t.create({key:o.key,frames:t.generateFrameNumbers(s,{frames:o.frames.map(mt(o.row,r))}),frameRate:i,repeat:(a=o.repeat)!=null?a:-1})})}const dt=Phaser.Events.EventEmitter;var _;(s=>{var i,o,a;let e;(n=>{n[n.Up=0]="Up",n[n.Down=1]="Down",n[n.Left=2]="Left",n[n.Right=3]="Right",n[n.A=4]="A",n[n.B=5]="B",n[n.Start=6]="Start",n[n.None=7]="None"})(e=s.Buttons||(s.Buttons={}));class t extends dt{constructor(){super(...arguments);c(this,i,re(ie({},st(it(e,()=>new r(!1,!0)),(h,y)=>rt(Number(y)))),{[7]:new r(!0,!0)}))}isPressed(...h){return h.some(y=>l(this,i)[y].isPressed())}press(h,y,x=!0){!l(this,i)[h].isEnabled()||(l(this,i)[h].setPressed(y),x&&this.emit("change",this))}pressMany(h,y,x=!0){y.forEach(te=>{!l(this,i)[te].isEnabled()||l(this,i)[te].setPressed(h)}),x&&this.emit("change",this)}}i=new WeakMap,s.Gamepad=t;class r{constructor(f,h){c(this,o,void 0);c(this,a,void 0);u(this,o,f),u(this,a,h)}isPressed(){return l(this,o)}setPressed(f){u(this,o,f)}isEnabled(){return l(this,a)}}o=new WeakMap,a=new WeakMap})(_||(_={}));function Pe(s){return{x:Math.trunc(s.x/d.graphics.tile.width),y:Math.trunc(s.y/d.graphics.tile.height)}}function ut(s){return s%2===0}const ft=_.Gamepad,g=_.Buttons;var P=(s=>(s[s.Slowest=1]="Slowest",s[s.Slow=2]="Slow",s[s.Mid=4]="Mid",s[s.Fast=5]="Fast",s))(P||{});const gt={x:[g.Left,g.Right],y:[g.Up,g.Down]},yt={x:"width",y:"height"};var le,Ge,pe,He;class ee{constructor(e,t,r,i,o,a,n,f=!1,h="initial"){c(this,le);c(this,pe);p(this,"movement");p(this,"movementType");p(this,"gamepad");p(this,"speed");this.name=e,this.sprite=t,this.gamepad=new ft,this.sprite.name=this.name,this.sprite.setData("player",this),this.sprite.setOrigin(0,0),this.sprite.setPosition(r*d.graphics.tile.width,i*d.graphics.tile.height),this.sprite.setImmovable(f),this.sprite.setScale(2.5),Ve(this.name,o,this.sprite.anims,a,n),this.sprite.anims.play(h),this.gamepad.addListener("change",b(this,le,Ge),this)}update(e,t){b(this,pe,He).call(this)}kill(){if(!this.sprite.anims.exists("death")){this.sprite.destroy();return}this.sprite.anims.play("death"),this.sprite.once(Phaser.Animations.Events.ANIMATION_COMPLETE,()=>this.sprite.destroy())}startMovement(){var e;(e=this.movement)==null||e.start()}handleExtraMovement(e,t){if(this.gamepad.isPressed(...gt[t]))return;const r=this.sprite.getCenter(),i=r[t]%d.graphics.tile[yt[t]],o=Pe(r);ut(o[t])||(i>=6&&i<20?this.sprite.body.velocity[t]=e:i>20&&i<34?this.sprite.body.velocity[t]=-e:this.sprite.body.velocity[t]=0)}}le=new WeakSet,Ge=function(e){this.sprite.anims.getName()!=="death"&&(e.isPressed(g.Right)?this.sprite.anims.play("right",!0):e.isPressed(g.Left)?this.sprite.anims.play("left",!0):e.isPressed(g.Up)?this.sprite.anims.play("up",!0):e.isPressed(g.Down)?this.sprite.anims.play("down",!0):this.sprite.anims.pause())},pe=new WeakSet,He=function(){if(this.sprite.anims.getName()==="death"){this.sprite.setVelocity(0,0);return}const e=this.speed*30;this.gamepad.isPressed(g.Up)?this.sprite.setVelocityY(-e):this.gamepad.isPressed(g.Down)?this.sprite.setVelocityY(e):this.sprite.setVelocityY(0),this.gamepad.isPressed(g.Right)?this.sprite.setVelocityX(e):this.gamepad.isPressed(g.Left)?this.sprite.setVelocityX(-e):this.sprite.setVelocityX(0),this.gamepad.isPressed(g.Right,g.Left)&&this.handleExtraMovement(e,"y"),this.gamepad.isPressed(g.Up,g.Down)&&this.handleExtraMovement(e,"x")};const m={FireUp:"fire-up",BombUp:"bomb-up",RemoteControl:"remote-control",SpeedUp:"speed-up",WallPass:"wall-pass",BombPass:"bomb-pass",FlamePass:"flame-pass",Invincible:"invincible",Door:"door"},ge={[m.FireUp]:s=>s.fireLength++,[m.BombUp]:s=>s.bombLength++,[m.RemoteControl]:s=>s.detonator=!0,[m.SpeedUp]:s=>s.speed=P.Fast,[m.BombPass]:s=>s.setBombPass(!0),[m.WallPass]:s=>s.setWallPass(!0),[m.FlamePass]:s=>s.flamePass=!0,[m.Invincible]:()=>{},[m.Door]:()=>{}},Oe=class extends ee{constructor(e,t,r,i){super(Oe.playerName,e,r,i,[{key:m.FireUp,row:0,frames:[0]},{key:m.BombUp,row:0,frames:[1]},{key:m.RemoteControl,row:0,frames:[2]},{key:m.SpeedUp,row:0,frames:[3]},{key:m.BombPass,row:0,frames:[4]},{key:m.WallPass,row:0,frames:[5]},{key:m.FlamePass,row:0,frames:[6]},{key:m.Invincible,row:0,frames:[7]},{key:m.Door,row:0,frames:[8]}],9,1,!1,t),this.itemType=t}applySkill(e){var t;(t=ge[this.itemType])==null||t.call(ge,e),this.kill()}};let W=Oe;p(W,"playerName","item");const wt=8;var V;const Me=class extends ee{constructor(t,r,i,o,a){super(Me.playerName,t.get(),i,o,[{key:"initial",row:0,frames:[0]},{key:"death",row:5,frames:[0,1,2],repeat:0}],6,wt,!0);c(this,V,void 0);u(this,V,a),this.setHiddenItem(r,i,o)}setHiddenItem(t,r,i){!l(this,V)||this.sprite.once(Phaser.Animations.Events.ANIMATION_COMPLETE,()=>{new W(t.get(),l(this,V),r,i)})}};let E=Me;V=new WeakMap,p(E,"playerName","brick");class bt{constructor(e){p(this,"group");p(this,"itemsGroup");this.group=e.physics.add.group({defaultKey:E.playerName}),this.itemsGroup=e.physics.add.group({defaultKey:W.playerName})}generateRandom(e){const t=e.randomBricks(),r=L(t.length-1),i=Object.values(m);t.forEach((o,a)=>{const n=i[L(i.length-2)],f=r===a?m.Door:n;new E(this.group,this.itemsGroup,o.x,o.y,f)})}}const oe=_.Buttons;_.Gamepad;var Ke=(s=>(s[s.Low=0]="Low",s[s.Mid=1]="Mid",s[s.High=2]="High",s[s.Impossible=3]="Impossible",s))(Ke||{}),j,G,M,Y;class vt{constructor(e){c(this,j,void 0);c(this,G,void 0);c(this,M,[]);c(this,Y,void 0);if(u(this,j,e),u(this,G,l(this,j).gamepad),l(this,j).movementType===3)throw new Error("Impossible movement type hasn't been implemented")}start(){const e=()=>{l(this,j).movementType===0?this.makeMovement(L(0,3)):this.makeMovement(L(0,1),L(2,3))};e(),u(this,Y,setInterval(e,3e3))}stop(){clearInterval(l(this,Y))}makeMovement(e,t){l(this,G).pressMany(!1,l(this,M),!1),u(this,M,[]),e===0?l(this,M).push(oe.Left):e===1&&l(this,M).push(oe.Right),e===2||t===2?l(this,M).push(oe.Up):(e===3||t===3)&&l(this,M).push(oe.Down),l(this,G).pressMany(!0,l(this,M))}}j=new WeakMap,G=new WeakMap,M=new WeakMap,Y=new WeakMap;const Pt=5;class B extends ee{constructor(e,t,r,i){super(e,t,r,i,[{key:"initial",row:1,frames:[0]},{key:"up",row:1,frames:[0,1,2]},{key:"down",row:2,frames:[0,1,2]},{key:"right",row:3,frames:[0,1,2]},{key:"left",row:4,frames:[0,1,2]},{key:"death",row:5,frames:[0,1,2,3],repeat:0}],5,Pt),this.movement=new vt(this),this.sprite.setDepth(2),this.sprite.setBounce(1,1)}kill(){var e;super.kill(),(e=this.movement)==null||e.stop()}}var Ot=Object.defineProperty,Mt=Object.getOwnPropertyDescriptor,Nt=(s,e,t,r)=>{for(var i=r>1?void 0:r?Mt(e,t):e,o=s.length-1,a;o>=0;o--)(a=s[o])&&(i=(r?a(e,t,i):a(i))||i);return r&&i&&Ot(e,t,i),i};let Se=class extends B{constructor(s,e,t){super("balloom",s.get(),e,t),this.speed=P.Slowest,this.movementType=Ke.Low}};Se=Nt([A({type:D.BALLOOM})],Se);var Lt=Object.defineProperty,Dt=Object.getOwnPropertyDescriptor,xt=(s,e,t,r)=>{for(var i=r>1?void 0:r?Dt(e,t):e,o=s.length-1,a;o>=0;o--)(a=s[o])&&(i=(r?a(e,t,i):a(i))||i);return r&&i&&Lt(e,t,i),i};let Ae=class extends B{constructor(s,e,t){super("doll",s.get(),e,t),this.speed=P.Slow}};Ae=xt([A({type:D.DOLL})],Ae);var Ct=Object.defineProperty,kt=Object.getOwnPropertyDescriptor,_t=(s,e,t,r)=>{for(var i=r>1?void 0:r?kt(e,t):e,o=s.length-1,a;o>=0;o--)(a=s[o])&&(i=(r?a(e,t,i):a(i))||i);return r&&i&&Ct(e,t,i),i};let Be=class extends B{constructor(s,e,t){super("kondoria",s.get(),e,t),this.speed=P.Slowest}};Be=_t([A({type:D.KONDORIA})],Be);var Et=Object.defineProperty,St=Object.getOwnPropertyDescriptor,At=(s,e,t,r)=>{for(var i=r>1?void 0:r?St(e,t):e,o=s.length-1,a;o>=0;o--)(a=s[o])&&(i=(r?a(e,t,i):a(i))||i);return r&&i&&Et(e,t,i),i};let Te=class extends B{constructor(s,e,t){super("minvo",s.get(),e,t),this.speed=P.Mid}};Te=At([A({type:D.MINVO})],Te);var Bt=Object.defineProperty,Tt=Object.getOwnPropertyDescriptor,It=(s,e,t,r)=>{for(var i=r>1?void 0:r?Tt(e,t):e,o=s.length-1,a;o>=0;o--)(a=s[o])&&(i=(r?a(e,t,i):a(i))||i);return r&&i&&Bt(e,t,i),i};let Ie=class extends B{constructor(s,e,t){super("oneal",s.get(),e,t),this.speed=P.Slow}};Ie=It([A({type:D.ONEAL})],Ie);var $t=Object.defineProperty,jt=Object.getOwnPropertyDescriptor,Rt=(s,e,t,r)=>{for(var i=r>1?void 0:r?jt(e,t):e,o=s.length-1,a;o>=0;o--)(a=s[o])&&(i=(r?a(e,t,i):a(i))||i);return r&&i&&$t(e,t,i),i};let $e=class extends B{constructor(s,e,t){super("ovapi",s.get(),e,t),this.speed=P.Slowest}};$e=Rt([A({type:D.OVAPI})],$e);var Ut=Object.defineProperty,Wt=Object.getOwnPropertyDescriptor,Ft=(s,e,t,r)=>{for(var i=r>1?void 0:r?Wt(e,t):e,o=s.length-1,a;o>=0;o--)(a=s[o])&&(i=(r?a(e,t,i):a(i))||i);return r&&i&&Ut(e,t,i),i};let je=class extends B{constructor(s,e,t){super("pass",s.get(),e,t),this.speed=P.Mid}};je=Ft([A({type:D.PASS})],je);var Vt=Object.defineProperty,Gt=Object.getOwnPropertyDescriptor,Ht=(s,e,t,r)=>{for(var i=r>1?void 0:r?Gt(e,t):e,o=s.length-1,a;o>=0;o--)(a=s[o])&&(i=(r?a(e,t,i):a(i))||i);return r&&i&&Vt(e,t,i),i};let Re=class extends B{constructor(s,e,t){super("pontan",s.get(),e,t),this.speed=P.Mid}};Re=Ht([A({type:D.PONTAN})],Re);class Kt{constructor(e){p(this,"group");this.group=e.physics.add.group({defaultKey:E.playerName})}generateRandom(e){e.randomEnemies().forEach(r=>{const i=lt(r.type);new i(this.group,r.x,r.y).startMovement()})}update(e,t){this.group.children.each(r=>{r.getData("player").update(e,t)})}}const Xt={right:"horizontal",left:"horizontal",up:"vertical",down:"vertical"},Yt=8;function ae(s,e,t){return s==="x"&&(e==="up"||e==="down")||s==="y"&&(e==="right"||e==="left")?0:t*(e==="up"||e==="left"?-1:1)}function qt(s,e){return s==="up"||s==="down"?{width:d.graphics.tile.width,height:e*d.graphics.tile.height}:{width:e*d.graphics.tile.width,height:d.graphics.tile.height}}var q,be,z,ve;class zt{constructor(e,t,r){c(this,q);c(this,z);p(this,"group");this.group=e.physics.add.group({defaultKey:"fire"});const i=[{key:"center",row:0,frames:[0,1,2,3],repeat:0},{key:"up",row:1,frames:[0,1,2,3],repeat:0},{key:"down",row:2,frames:[0,1,2,3],repeat:0},{key:"right",row:3,frames:[0,1,2,3],repeat:0},{key:"left",row:4,frames:[0,1,2,3],repeat:0},{key:"horizontal",row:5,frames:[0,1,2,3],repeat:0},{key:"vertical",row:6,frames:[0,1,2,3],repeat:0}],o=["up","down","left","right"],a=b(this,q,be).call(this,i);a.anims.play("center"),a.setPosition(t.x*d.graphics.tile.width,t.y*d.graphics.tile.height);for(const n of o){const f={x:t.x+ae("x",n,n==="right"?1:r),y:t.y+ae("y",n,n==="down"?1:r)},h=e.tileMap.tileMap.tileToWorldXY(f.x,f.y),y=qt(n,r);e.tileMap.tileMap.getTilesWithinWorldXY(h.x+1,h.y+1,y.width-2,y.height-2,{isColliding:!0});const x=e.physics.overlapRect(h.x+1,h.y+1,y.width-2,y.height-2,!0,!0);(n==="right"||n==="down")&&x.reverse();const te=x.filter(C=>{var w;return((w=C.gameObject)==null?void 0:w.name)===E.playerName}),ze=x.filter(C=>{var w;return((w=C.gameObject)==null?void 0:w.name)===S.playerName}),De=e.physics.closest(a,te),xe=e.physics.closest(a,ze);for(let C=1;C<=r;C++){const w={x:t.x+ae("x",n,C),y:t.y+ae("y",n,C)};if(N.isSolidBlock(w.x,w.y))break;const se=e.tileMap.tileMap.tileToWorldXY(w.x,w.y);if(De&&se.equals(De)||xe&&se.equals(xe)){b(this,z,ve).call(this,x,w,e.tileMap.tileMap);break}const me=b(this,q,be).call(this,i);me.setPosition(se.x,se.y),C===r?me.anims.play(n):me.anims.play(Xt[n]),b(this,z,ve).call(this,x,w,e.tileMap.tileMap)}}}}q=new WeakSet,be=function(e){const t=this.group.get();return t.setOrigin(0,0),t.setImmovable(!0),t.setScale(2.5),t.once(Phaser.Animations.Events.ANIMATION_COMPLETE,()=>t.destroy()),Ve("fire",e,t.anims,4,Yt),t},z=new WeakSet,ve=function(e,t,r){e.filter(i=>r.worldToTileXY(i.center.x,i.center.y).equals(t)).forEach(i=>{const o=i.gameObject.getData("player");i.gameObject.name===S.playerName?o==null||o.detonate():(!(o instanceof U)||!o.flamePass)&&(o==null||o.kill())})};const Jt=3;var J;const Ne=class extends ee{constructor(t,r,i,o){super(Ne.playerName,t.get(),i,o,[{key:"initial",row:0,frames:[0,1,2]},{key:"death",row:0,frames:[3],repeat:0}],4,Jt,!0);c(this,J,void 0);u(this,J,r),this.sprite.setDepth(1),r.detonator||setTimeout(()=>{this.detonate()},3200)}detonate(){if(!this.sprite.anims||this.sprite.anims.getName()==="death")return;const t=this.sprite.scene;this.sprite.anims.play("death"),this.kill();const r=Pe(this.sprite.getCenter());new zt(t,r,l(this,J).fireLength)}kill(){var t;super.kill(),(t=this.sprite.anims)==null||t.complete()}};let S=Ne;J=new WeakMap,p(S,"playerName","bomb");class Qt{constructor(e){p(this,"group");this.group=e.physics.add.group({defaultKey:S.playerName})}addBomb(e,t,r){new S(this.group,e,t,r)}detonate(){var t;const e=(t=this.group.getChildren().at(0))==null?void 0:t.getData("player");e==null||e.detonate()}}const T=_.Buttons,Xe={Up:T.Up,Down:T.Down,Left:T.Left,Right:T.Right,x:T.A,z:T.B,Enter:T.Start};function Ue(s,e){return t=>{const r=Xe[e];We(r)||s.gamepad.press(r,t.isDown)}}function Zt(s,e){const t=s.addKeys(Object.keys(Xe).join(","),!0,!0);return Object.entries(t).forEach(([r,i])=>{i.on("down",Ue(e,r)),i.on("up",Ue(e,r))}),()=>Object.entries(t).forEach(([r,i])=>{i.destroy()})}const k=_.Buttons;function es(s){const e=s.gamepad,t=ot.create({mode:"static",position:{left:"100px",bottom:"100px"}}),r=()=>{e.pressMany(!1,[k.Right,k.Up,k.Left,k.Down])},i=(o,a)=>{const n=[],f=[];let h;!a.distance||(h=a.angle.degree<=60||a.angle.degree>=300?n:f,h.push(k.Right),h=a.angle.degree>=30&&a.angle.degree<=150?n:f,h.push(k.Up),h=a.angle.degree>=120&&a.angle.degree<=240?n:f,h.push(k.Left),h=a.angle.degree>=210&&a.angle.degree<=330?n:f,h.push(k.Down),e.pressMany(!0,n),e.pressMany(!1,f))};return t.on("end",r),t.on("move",i),()=>{t.off("end",r),t.off("move",i)}}function ts(s){const e=s.gamepad,t=document.querySelector("body"),r=document.createElement("div"),i=document.createElement("img");i.src="assets/joystick/bomb-btn.png",r.appendChild(i),Object.assign(r.style,{bottom:"50px",display:"flex",opacity:"0.5",position:"absolute",right:"50px",transition:"opacity 250ms ease 0s"}),Object.assign(i.style,{width:"100px",pointerEvents:"none",userSelect:"none"}),t.appendChild(r);const o=a=>{a.stopPropagation();const n=a.type==="pointerdown";r.style.opacity=n?"0.8":"0.5",e.press(k.A,n)};return r.addEventListener("pointerdown",o),r.addEventListener("pointerup",o),()=>{r.removeEventListener("pointerdown",o),r.removeEventListener("pointerup",o)}}function ss(s){const e=es(s),t=ts(s);return()=>{e(),t()}}const ye=_.Buttons,is=6;var Q,Z,he,Ye;const Le=class extends ee{constructor(t,r,i,o){super(Le.playerName,t,i,o,[{key:"initial",row:0,frames:[0]},{key:"up",row:1,frames:[2,1,0,1]},{key:"down",row:2,frames:[2,1,0,1]},{key:"right",row:3,frames:[2,1,0,1]},{key:"left",row:4,frames:[2,1,0,1]},{key:"death",row:5,frames:[0,1,2,3,4],repeat:0}],6,is);c(this,he);p(this,"bombs");p(this,"bombLength");p(this,"detonator");p(this,"fireLength");p(this,"flamePass");c(this,Q,void 0);c(this,Z,void 0);this.bombs=new Qt(r),this.speed=P.Mid,this.detonator=!1,this.fireLength=2,this.bombLength=1,this.flamePass=!1,this.sprite.setDepth(3),u(this,Q,Zt(r.input.keyboard,this)),u(this,Z,ss(this))}update(t,r,i,o){super.update(t,r),b(this,he,Ye).call(this,i,o)}kill(){super.kill(),l(this,Q).call(this),l(this,Z).call(this)}setBombPass(t){this.sprite.scene.physics.world.colliders.getActive().filter(r=>r.name==="playerBombsCollision").forEach(r=>r.destroy())}setWallPass(t){this.sprite.scene.physics.world.colliders.getActive().filter(r=>r.name==="playerBrickCollision").forEach(r=>r.destroy())}};let U=Le;Q=new WeakMap,Z=new WeakMap,he=new WeakSet,Ye=function(t,r){if(this.gamepad.isPressed(ye.A)&&this.bombs.group.getLength()<this.bombLength&&!t.overlap(this.sprite,this.bombs.group)&&!t.overlap(this.sprite,r.bricks.group)){const i=this.sprite.getCenter(),{x:o,y:a}=Pe(i);this.bombs.addBomb(this,o,a)}this.gamepad.isPressed(ye.B)&&this.detonator&&(this.bombs.detonate(),this.gamepad.press(ye.B,!1))},p(U,"playerName","bomberman");function rs(s,e){const t=s.scene,r=t.tileMap.tileMap.worldToTileXY(s.body.center.x,s.body.center.y),i=t.tileMap.tileMap.worldToTileXY(e.body.center.x,e.body.center.y);return r.equals(i)}var ce,qe;class os{constructor(e,t){c(this,ce);p(this,"group");this.group=e.physics.add.group({defaultKey:U.playerName}),e.physics.add.overlap(this.group,t.itemsGroup,b(this,ce,qe),rs)}addPlayer(e,t,r){const i=new U(this.group.get(),e,t,r),o=this.group.getChildren().map(a=>a.getData("player").bombs.group);e.physics.add.collider(i.sprite,e.tileMap.itemTileSetLayer),e.physics.add.collider(i.bombs.group,e.tileMap.itemTileSetLayer),e.physics.add.collider(i.sprite,e.tileMap.bricks.group).setName("playerBrickCollision"),e.physics.add.collider(i.bombs.group,o),e.physics.add.collider(i.sprite,o).setName("playerBombsCollision"),e.physics.add.collider(e.tileMap.enemies.group,[i.bombs.group,e.tileMap.bricks.group]),e.physics.add.collider(e.tileMap.enemies.group,e.tileMap.itemTileSetLayer),e.cameras.main.startFollow(i.sprite,!0)}update(e,t,r){const i=this.group.scene;this.group.children.each(o=>{o.getData("player").update(e,t,r,i.tileMap)}),this.group.children.size===0&&this.addPlayer(i,1,1)}}ce=new WeakSet,qe=function(e,t){const r=e.scene,i=e.getData("player"),o=t.getData("player");o.itemType===m.Door&&r.tileMap.enemies.group.getLength()===0||o.itemType!==m.Door&&o.applySkill(i)};var R;class as{constructor(e){p(this,"itemTileSetLayer");c(this,R,void 0);p(this,"tileMap");p(this,"bricks");p(this,"enemies");p(this,"players");u(this,R,new N),this.tileMap=e.make.tilemap({data:l(this,R).emptyMap,width:d.graphics.sceneWidth,height:d.graphics.sceneHeight,tileWidth:d.graphics.tile.width,tileHeight:d.graphics.tile.height});const t=this.tileMap.addTilesetImage("map",void 0,16,16);this.itemTileSetLayer=this.tileMap.createLayer(0,t),this.bricks=new bt(e),this.players=new os(e,this.bricks),this.enemies=new Kt(e),this.tileMap.setCollision(0)}reset(e){this.players.addPlayer(e,1,1),this.bricks.generateRandom(l(this,R)),this.enemies.generateRandom(l(this,R))}update(e,t,r){this.players.update(e,t,r.physics),this.enemies.update(e,t)}}R=new WeakMap;const K=16,X=16;class ns extends Fe.exports.Scene{constructor(){super("GameScene");p(this,"tileMap")}preload(){this.load.image("map","assets/map/map-items.png"),this.load.spritesheet(W.playerName,"assets/map/items.png",{frameWidth:K,frameHeight:X}),this.load.spritesheet(E.playerName,"assets/map/brick.png",{frameWidth:K,frameHeight:X}),this.load.spritesheet(S.playerName,"assets/map/bomb.png",{frameWidth:K,frameHeight:X}),this.load.spritesheet("fire","assets/map/fire.png",{frameWidth:K,frameHeight:X}),[U.playerName,"balloom","doll","kondoria","minvo","oneal","ovapi","pass","pontan"].forEach(t=>this.load.spritesheet(t,`assets/players/${t}.png`,{frameWidth:K,frameHeight:X}))}create(){this.tileMap=new as(this),this.tileMap.reset(this),this.cameras.main.setBounds(0,0,d.graphics.sceneWidth,d.graphics.sceneHeight),this.physics.world.setBounds(0,0,d.graphics.sceneWidth,d.graphics.sceneHeight)}update(t,r){super.update(t,r),this.tileMap.update(t,r,this)}}new Fe.exports.Game(re(ie({},ct),{scene:[ns]}));
