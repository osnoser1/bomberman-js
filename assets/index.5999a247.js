var Pe=Object.defineProperty,_e=Object.defineProperties;var De=Object.getOwnPropertyDescriptors;var te=Object.getOwnPropertySymbols;var Le=Object.prototype.hasOwnProperty,Me=Object.prototype.propertyIsEnumerable;var z=(s,e,t)=>e in s?Pe(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,K=(s,e)=>{for(var t in e||(e={}))Le.call(e,t)&&z(s,t,e[t]);if(te)for(var t of te(e))Me.call(e,t)&&z(s,t,e[t]);return s},U=(s,e)=>_e(s,De(e));var p=(s,e,t)=>(z(s,typeof e!="symbol"?e+"":e,t),t),J=(s,e,t)=>{if(!e.has(s))throw TypeError("Cannot "+t)};var a=(s,e,t)=>(J(s,e,"read from private field"),t?t.call(s):e.get(s)),l=(s,e,t)=>{if(e.has(s))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(s):e.set(s,t)},c=(s,e,t,r)=>(J(s,e,"write to private field"),r?r.call(s,t):e.set(s,t),t);var M=(s,e,t)=>(J(s,e,"access private method"),t);import{i as fe,r as _,o as Ce,m as $e,a as Se,n as Ae,p as ge}from"./vendor.b8ce2bad.js";const Ne=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&r(n)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}};Ne();var g=(s=>(s[s.BALLOOM=0]="BALLOOM",s[s.ONEAL=1]="ONEAL",s[s.DOLL=2]="DOLL",s[s.MINVO=3]="MINVO",s[s.KONDORIA=4]="KONDORIA",s[s.OVAPI=5]="OVAPI",s[s.PASS=6]="PASS",s[s.PONTAN=7]="PONTAN",s[s.Length=8]="Length",s))(g||{});const ee={};function D(s){return e=>{xe(U(K({},s),{enemyClass:e}))}}function xe(s){if(fe(s.type))throw new TypeError("config.type is required");if(ee[s.type])throw new Error(`The enemy with the name "${s.enemyClass.name}" has already exists, please try another name!`);ee[s.type]=s.enemyClass}function Be(s){return ee[s]}const Q=0,I=1,ie=Number.EPSILON;var d,$,S,j,k;const m=class{constructor(){l(this,j);l(this,d,void 0);l(this,$,void 0);l(this,S,void 0);c(this,d,M(this,j,k).call(this,Q,I)),c(this,$,[]),c(this,S,[])}get emptyMap(){return M(this,j,k).call(this,Q,I)}get value(){return a(this,d)}randomBricks(){c(this,d,M(this,j,k).call(this,Q,I)),c(this,$,[]);for(let e=0;e<m.BrickCount;e++)do{let t=_(m.Columns-2),r=_(m.Rows-2);if(!(t<3&&r==1||t==1&&r<3)&&a(this,d)[r][t]===I){a(this,$).push({x:t,y:r}),a(this,d)[r][t]=ie;break}}while(!0);return a(this,$)}randomEnemies(){c(this,S,[]);for(let e=0;e<m.EnemiesCount;e++)do{let t=_(m.Columns-2),r=_(m.Rows-2),i=_(g.Length-1);if(a(this,d)[r][t]===I){a(this,S).push({x:t,y:r,type:i}),a(this,d)[r][t]=ie;break}}while(!0);return a(this,S)}};let v=m;d=new WeakMap,$=new WeakMap,S=new WeakMap,j=new WeakSet,k=function(e,t){const r=[];for(let i=0;i<m.Rows;i++){r.push([]);for(let o=0;o<m.Columns;o++){const n=i%2!=1&&o%2!=1||i==0||i==12||o==0||o==30?e:t;r[i].push(n)}}return r},p(v,"Columns",31),p(v,"Rows",13),p(v,"BrickCount",55),p(v,"EnemiesCount",10);const je=Phaser.Scale.ScaleModes,Ee=Phaser.Scale.Center,re=40,oe=40,u={scale:{width:640,height:520},graphics:{tileWidth:re,tileHeight:oe,sceneWidth:v.Columns*re,sceneHeight:v.Rows*oe}},Re={type:Phaser.AUTO,fps:{target:60},pixelArt:!0,scale:{width:u.scale.width,height:u.scale.height,mode:je.FIT,autoCenter:Ee.CENTER_BOTH},physics:{default:"arcade",arcade:{debug:!0}}};function Ie(s,e){return{x:Math.trunc(s/u.graphics.tileWidth),y:Math.trunc(e/u.graphics.tileHeight)}}const He=(s,e)=>t=>s*e+t;function Ve(s,e,t,r,i){e.forEach(o=>{t.create({key:o.key,frames:t.generateFrameNumbers(s,{frames:o.frames.map(He(o.row,r))}),frameRate:i,repeat:-1})})}const Ke=Phaser.Events.EventEmitter;var y;(s=>{var i,o,n;let e;(h=>{h[h.Up=0]="Up",h[h.Down=1]="Down",h[h.Left=2]="Left",h[h.Right=3]="Right",h[h.A=4]="A",h[h.B=5]="B",h[h.Start=6]="Start",h[h.None=7]="None"})(e=s.Buttons||(s.Buttons={}));class t extends Ke{constructor(){super(...arguments);l(this,i,U(K({},Ce($e(e,()=>new r(!1,!0)),(w,R)=>Se(Number(R)))),{[7]:new r(!0,!0)}))}isPressed(w){return a(this,i)[w].isPressed()}press(w,R,q=!0){!a(this,i)[w].isEnabled()||(a(this,i)[w].setPressed(R),q&&this.emit("change",this))}pressMany(w,R,q=!0){R.forEach(se=>{!a(this,i)[se].isEnabled()||a(this,i)[se].setPressed(w)}),q&&this.emit("change",this)}}i=new WeakMap,s.Gamepad=t;class r{constructor(B,w){l(this,o,void 0);l(this,n,void 0);c(this,o,B),c(this,n,w)}isPressed(){return a(this,o)}setPressed(B){c(this,o,B)}isEnabled(){return a(this,n)}}o=new WeakMap,n=new WeakMap})(y||(y={}));const Ue=y.Gamepad,O=y.Buttons;var b=(s=>(s[s.Slowest=1]="Slowest",s[s.Slow=2]="Slow",s[s.Mid=4]="Mid",s[s.Fast=5]="Fast",s))(b||{}),G,be,F,we;class Y{constructor(e,t,r,i,o,n,h,B=!1){l(this,G);l(this,F);p(this,"movementType");p(this,"movement");p(this,"gamepad");p(this,"speed");this.name=e,this.sprite=t,this.gamepad=new Ue,this.sprite.setOrigin(0,0),this.sprite.setPosition(r*u.graphics.tileWidth,i*u.graphics.tileHeight),this.sprite.setImmovable(B),this.sprite.setScale(2.5),Ve(this.name,o,this.sprite.anims,n,h),this.sprite.anims.play("initial"),this.gamepad.addListener("change",M(this,G,be),this)}update(e,t){M(this,F,we).call(this)}}G=new WeakSet,be=function(e){e.isPressed(O.Right)?this.sprite.anims.play("right",!0):e.isPressed(O.Left)?this.sprite.anims.play("left",!0):e.isPressed(O.Up)?this.sprite.anims.play("up",!0):e.isPressed(O.Down)?this.sprite.anims.play("down",!0):this.sprite.anims.pause()},F=new WeakSet,we=function(){this.gamepad.isPressed(O.Up)?this.sprite.setVelocityY(-this.speed*30):this.gamepad.isPressed(O.Down)?this.sprite.setVelocityY(this.speed*30):this.sprite.setVelocityY(0),this.gamepad.isPressed(O.Right)?this.sprite.setVelocityX(this.speed*30):this.gamepad.isPressed(O.Left)?this.sprite.setVelocityX(-this.speed*30):this.sprite.setVelocityX(0)};const We=y.Buttons,ke=6;var X,ve;class Ge extends Y{constructor(t,r,i,o){const n=t.physics.add.sprite(0,0,"bomberman");super("bomberman",n,i,o,[{key:"initial",row:0,frames:[0]},{key:"up",row:1,frames:[2,1,0,1]},{key:"down",row:2,frames:[2,1,0,1]},{key:"right",row:3,frames:[2,1,0,1]},{key:"left",row:4,frames:[2,1,0,1]},{key:"death",row:5,frames:[0,1,2,3,4]}],6,ke);l(this,X);this.bombs=r,this.speed=b.Mid,this.sprite.setDepth(1)}update(t,r,i,o){super.update(t,r),M(this,X,ve).call(this,i,o)}}X=new WeakSet,ve=function(t,r){if(this.gamepad.isPressed(We.A)&&!t.overlap(this.sprite,this.bombs.group)&&!t.overlap(this.sprite,r.bricks.group)){const i=this.sprite.getCenter(),{x:o,y:n}=Ie(i.x,i.y);this.bombs.addBomb(o,n)}};const Fe=3;class Xe extends Y{constructor(e,t,r){super("bomb",e.get(),t,r,[{key:"initial",row:0,frames:[0,1,2]}],6,Fe,!0)}}class Ye{constructor(e){p(this,"group");this.group=e.physics.add.group({defaultKey:"bomb"})}addBomb(e,t){new Xe(this.group,e,t)}}const qe=3;class ze extends Y{constructor(e,t,r){super("brick",e.get(),t,r,[{key:"initial",row:0,frames:[0]},{key:"dead",row:5,frames:[0,1,2]}],6,qe,!0)}}class Je{constructor(e){p(this,"group");this.group=e.physics.add.group({defaultKey:"brick"})}generateRandom(e){e.randomBricks().forEach(r=>new ze(this.group,r.x,r.y))}}const W=y.Buttons;y.Gamepad;var ye=(s=>(s[s.Low=0]="Low",s[s.Mid=1]="Mid",s[s.High=2]="High",s[s.Impossible=3]="Impossible",s))(ye||{}),A,E,f,H;class Qe{constructor(e){l(this,A,void 0);l(this,E,void 0);l(this,f,[]);l(this,H,void 0);if(c(this,A,e),c(this,E,a(this,A).gamepad),a(this,A).movementType===3)throw new Error("Impossible movement type hasn't been implemented")}start(){const e=()=>{a(this,A).movementType===0?this.makeMovement(_(0,3)):this.makeMovement(_(0,1),_(2,3))};e(),c(this,H,setInterval(e,3e3))}stop(){clearInterval(a(this,H))}makeMovement(e,t){a(this,E).pressMany(!1,a(this,f),!1),c(this,f,[]),e===0?a(this,f).push(W.Left):e===1&&a(this,f).push(W.Right),e===2||t===2?a(this,f).push(W.Up):(e===3||t===3)&&a(this,f).push(W.Down),a(this,E).pressMany(!0,a(this,f))}}A=new WeakMap,E=new WeakMap,f=new WeakMap,H=new WeakMap;const Te=5;class L extends Y{constructor(e,t,r,i){super(e,t,r,i,[{key:"initial",row:1,frames:[0]},{key:"up",row:1,frames:[0,1,2]},{key:"down",row:2,frames:[0,1,2]},{key:"right",row:3,frames:[0,1,2]},{key:"left",row:4,frames:[0,1,2]},{key:"death",row:5,frames:[0,1,2,3]}],5,Te),this.movement=new Qe(this),this.sprite.setDepth(1),this.sprite.setBounce(1,1)}}var Ze=Object.defineProperty,es=Object.getOwnPropertyDescriptor,ss=(s,e,t,r)=>{for(var i=r>1?void 0:r?es(e,t):e,o=s.length-1,n;o>=0;o--)(n=s[o])&&(i=(r?n(e,t,i):n(i))||i);return r&&i&&Ze(e,t,i),i};let ne=class extends L{constructor(s,e,t){super("balloom",s.get(),e,t),this.speed=b.Slowest,this.movementType=ye.Low,this.sprite.setDepth(1)}};ne=ss([D({type:g.BALLOOM})],ne);var ts=Object.defineProperty,is=Object.getOwnPropertyDescriptor,rs=(s,e,t,r)=>{for(var i=r>1?void 0:r?is(e,t):e,o=s.length-1,n;o>=0;o--)(n=s[o])&&(i=(r?n(e,t,i):n(i))||i);return r&&i&&ts(e,t,i),i};let ae=class extends L{constructor(s,e,t){super("doll",s.get(),e,t),this.speed=b.Slow,this.sprite.setDepth(1)}};ae=rs([D({type:g.DOLL})],ae);var os=Object.defineProperty,ns=Object.getOwnPropertyDescriptor,as=(s,e,t,r)=>{for(var i=r>1?void 0:r?ns(e,t):e,o=s.length-1,n;o>=0;o--)(n=s[o])&&(i=(r?n(e,t,i):n(i))||i);return r&&i&&os(e,t,i),i};let he=class extends L{constructor(s,e,t){super("kondoria",s.get(),e,t),this.speed=b.Slowest,this.sprite.setDepth(1)}};he=as([D({type:g.KONDORIA})],he);var hs=Object.defineProperty,ps=Object.getOwnPropertyDescriptor,ls=(s,e,t,r)=>{for(var i=r>1?void 0:r?ps(e,t):e,o=s.length-1,n;o>=0;o--)(n=s[o])&&(i=(r?n(e,t,i):n(i))||i);return r&&i&&hs(e,t,i),i};let pe=class extends L{constructor(s,e,t){super("minvo",s.get(),e,t),this.speed=b.Mid,this.sprite.setDepth(1)}};pe=ls([D({type:g.MINVO})],pe);var cs=Object.defineProperty,us=Object.getOwnPropertyDescriptor,ms=(s,e,t,r)=>{for(var i=r>1?void 0:r?us(e,t):e,o=s.length-1,n;o>=0;o--)(n=s[o])&&(i=(r?n(e,t,i):n(i))||i);return r&&i&&cs(e,t,i),i};let le=class extends L{constructor(s,e,t){super("oneal",s.get(),e,t),this.speed=b.Slow,this.sprite.setDepth(1)}};le=ms([D({type:g.ONEAL})],le);var ds=Object.defineProperty,fs=Object.getOwnPropertyDescriptor,gs=(s,e,t,r)=>{for(var i=r>1?void 0:r?fs(e,t):e,o=s.length-1,n;o>=0;o--)(n=s[o])&&(i=(r?n(e,t,i):n(i))||i);return r&&i&&ds(e,t,i),i};let ce=class extends L{constructor(s,e,t){super("ovapi",s.get(),e,t),this.speed=b.Slowest,this.sprite.setDepth(1)}};ce=gs([D({type:g.OVAPI})],ce);var bs=Object.defineProperty,ws=Object.getOwnPropertyDescriptor,vs=(s,e,t,r)=>{for(var i=r>1?void 0:r?ws(e,t):e,o=s.length-1,n;o>=0;o--)(n=s[o])&&(i=(r?n(e,t,i):n(i))||i);return r&&i&&bs(e,t,i),i};let ue=class extends L{constructor(s,e,t){super("pass",s.get(),e,t),this.speed=b.Mid,this.sprite.setDepth(1)}};ue=vs([D({type:g.PASS})],ue);var ys=Object.defineProperty,Os=Object.getOwnPropertyDescriptor,Ps=(s,e,t,r)=>{for(var i=r>1?void 0:r?Os(e,t):e,o=s.length-1,n;o>=0;o--)(n=s[o])&&(i=(r?n(e,t,i):n(i))||i);return r&&i&&ys(e,t,i),i};let me=class extends L{constructor(s,e,t){super("pontan",s.get(),e,t),this.speed=b.Mid,this.sprite.setDepth(1)}};me=Ps([D({type:g.PONTAN})],me);var V;class _s{constructor(e){l(this,V,[]);p(this,"group");this.group=e.physics.add.group({defaultKey:"brick"})}generateRandom(e){e.randomEnemies().forEach(r=>{var n;const i=Be(r.type),o=new i(this.group,r.x,r.y);a(this,V).push(o),(n=o.movement)==null||n.start()})}update(e,t){a(this,V).forEach(r=>r.update(e,t))}}V=new WeakMap;var N,x;class Ds{constructor(e){p(this,"itemTileSetLayer");l(this,N,void 0);l(this,x,void 0);p(this,"bricks");p(this,"enemies");c(this,N,new v),c(this,x,e.make.tilemap({data:a(this,N).emptyMap,width:u.graphics.sceneWidth,height:u.graphics.sceneHeight,tileWidth:u.graphics.tileWidth,tileHeight:u.graphics.tileHeight}));const t=a(this,x).addTilesetImage("items",void 0,16,16);this.itemTileSetLayer=a(this,x).createLayer(0,t),this.bricks=new Je(e),this.enemies=new _s(e),a(this,x).setCollision(0)}reset(){this.bricks.generateRandom(a(this,N)),this.enemies.generateRandom(a(this,N))}update(e,t){this.enemies.update(e,t)}}N=new WeakMap,x=new WeakMap;const C=y.Buttons,Oe={Up:C.Up,Down:C.Down,Left:C.Left,Right:C.Right,x:C.A,c:C.B,Enter:C.Start};function de(s,e){return t=>{const r=Oe[e];fe(r)||s.gamepad.press(r,t.isDown)}}function Ls(s,e){const t=s.addKeys(Object.keys(Oe).join(","),!0,!0);Object.entries(t).forEach(([r,i])=>{i.on("down",de(e,r)),i.on("up",de(e,r))})}const P=y.Buttons;function Ms(s){const e=Ae.create(),t=s.gamepad;e.on("end",()=>{t.pressMany(!1,[P.Right,P.Up,P.Left,P.Down])}),e.on("move",(r,i)=>{const o=[],n=[];let h;!i.distance||(h=i.angle.degree<=60||i.angle.degree>=300?o:n,h.push(P.Right),h=i.angle.degree>=30&&i.angle.degree<=150?o:n,h.push(P.Up),h=i.angle.degree>=120&&i.angle.degree<=240?o:n,h.push(P.Left),h=i.angle.degree>=210&&i.angle.degree<=330?o:n,h.push(P.Down),t.pressMany(!0,o),t.pressMany(!1,n))})}const T=16,Z=16;class Cs extends ge.exports.Scene{constructor(){super("GameScene");p(this,"bomberman");p(this,"bombs");p(this,"tileMap")}preload(){this.load.image("items","assets/map/items.png"),this.load.spritesheet("brick","assets/map/brick.png",{frameWidth:T,frameHeight:Z}),this.load.spritesheet("bomb","assets/map/bomb.png",{frameWidth:T,frameHeight:Z}),["bomberman","balloom","doll","kondoria","minvo","oneal","ovapi","pass","pontan"].forEach(t=>this.load.spritesheet(t,`assets/players/${t}.png`,{frameWidth:T,frameHeight:Z}))}create(){this.tileMap=new Ds(this),this.tileMap.reset(),this.cameras.main.setBounds(0,0,u.graphics.sceneWidth,u.graphics.sceneHeight),this.physics.world.setBounds(0,0,u.graphics.sceneWidth,u.graphics.sceneHeight),this.bombs=new Ye(this),this.bomberman=new Ge(this,this.bombs,1,1),this.physics.add.collider(this.bomberman.sprite,this.tileMap.itemTileSetLayer),this.physics.add.collider(this.bombs.group,this.tileMap.itemTileSetLayer),this.physics.add.collider(this.bombs.group,this.bombs.group),this.physics.add.collider(this.bomberman.sprite,this.bombs.group),this.physics.add.collider(this.tileMap.enemies.group,[this.bombs.group,this.tileMap.bricks.group]),this.physics.add.collider(this.tileMap.enemies.group,this.tileMap.itemTileSetLayer),this.cameras.main.startFollow(this.bomberman.sprite,!0),Ls(this.input.keyboard,this.bomberman),Ms(this.bomberman)}update(t,r){super.update(t,r),this.bomberman.update(t,r,this.physics,this.tileMap),this.tileMap.update(t,r)}}new ge.exports.Game(U(K({},Re),{scene:[Cs]}));
