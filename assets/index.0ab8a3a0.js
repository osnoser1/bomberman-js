var Oe=Object.defineProperty,Pe=Object.defineProperties;var _e=Object.getOwnPropertyDescriptors;var se=Object.getOwnPropertySymbols;var De=Object.prototype.hasOwnProperty,Le=Object.prototype.propertyIsEnumerable;var q=(s,e,t)=>e in s?Oe(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,V=(s,e)=>{for(var t in e||(e={}))De.call(e,t)&&q(s,t,e[t]);if(se)for(var t of se(e))Le.call(e,t)&&q(s,t,e[t]);return s},K=(s,e)=>Pe(s,_e(e));var p=(s,e,t)=>(q(s,typeof e!="symbol"?e+"":e,t),t),z=(s,e,t)=>{if(!e.has(s))throw TypeError("Cannot "+t)};var n=(s,e,t)=>(z(s,e,"read from private field"),t?t.call(s):e.get(s)),c=(s,e,t)=>{if(e.has(s))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(s):e.set(s,t)},l=(s,e,t,r)=>(z(s,e,"write to private field"),r?r.call(s,t):e.set(s,t),t);var L=(s,e,t)=>(z(s,e,"access private method"),t);import{i as de,r as O,o as Me,m as Ce,a as Se,p as fe}from"./vendor.de490914.js";const $e=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}};$e();var g=(s=>(s[s.BALLOOM=0]="BALLOOM",s[s.ONEAL=1]="ONEAL",s[s.DOLL=2]="DOLL",s[s.MINVO=3]="MINVO",s[s.KONDORIA=4]="KONDORIA",s[s.OVAPI=5]="OVAPI",s[s.PASS=6]="PASS",s[s.PONTAN=7]="PONTAN",s[s.Length=8]="Length",s))(g||{});const Z={};function _(s){return e=>{Ae(K(V({},s),{enemyClass:e}))}}function Ae(s){if(de(s.type))throw new TypeError("config.type is required");if(Z[s.type])throw new Error(`The enemy with the name "${s.enemyClass.name}" has already exists, please try another name!`);Z[s.type]=s.enemyClass}function Ne(s){return Z[s]}const J=0,I=1,te=Number.EPSILON;var d,C,S,B,k;const m=class{constructor(){c(this,B);c(this,d,void 0);c(this,C,void 0);c(this,S,void 0);l(this,d,L(this,B,k).call(this,J,I)),l(this,C,[]),l(this,S,[])}get emptyMap(){return L(this,B,k).call(this,J,I)}get value(){return n(this,d)}randomBricks(){l(this,d,L(this,B,k).call(this,J,I)),l(this,C,[]);for(let e=0;e<m.BrickCount;e++)do{let t=O(m.Columns-2),r=O(m.Rows-2);if(!(t<3&&r==1||t==1&&r<3)&&n(this,d)[r][t]===I){n(this,C).push({x:t,y:r}),n(this,d)[r][t]=te;break}}while(!0);return n(this,C)}randomEnemies(){l(this,S,[]);for(let e=0;e<m.EnemiesCount;e++)do{let t=O(m.Columns-2),r=O(m.Rows-2),i=O(g.Length-1);if(n(this,d)[r][t]===I){n(this,S).push({x:t,y:r,type:i}),n(this,d)[r][t]=te;break}}while(!0);return n(this,S)}};let v=m;d=new WeakMap,C=new WeakMap,S=new WeakMap,B=new WeakSet,k=function(e,t){const r=[];for(let i=0;i<m.Rows;i++){r.push([]);for(let o=0;o<m.Columns;o++){const a=i%2!=1&&o%2!=1||i==0||i==12||o==0||o==30?e:t;r[i].push(a)}}return r},p(v,"Columns",31),p(v,"Rows",13),p(v,"BrickCount",55),p(v,"EnemiesCount",10);const xe=Phaser.Scale.ScaleModes,Be=Phaser.Scale.Center,ie=40,re=40,u={scale:{width:640,height:520},graphics:{tileWidth:ie,tileHeight:re,sceneWidth:v.Columns*ie,sceneHeight:v.Rows*re}},Ee={type:Phaser.AUTO,fps:{target:60},pixelArt:!0,scale:{width:u.scale.width,height:u.scale.height,mode:xe.FIT,autoCenter:Be.CENTER_BOTH},physics:{default:"arcade",arcade:{debug:!0}}};function je(s,e){return{x:Math.trunc(s/u.graphics.tileWidth),y:Math.trunc(e/u.graphics.tileHeight)}}const Ie=(s,e)=>t=>s*e+t;function Re(s,e,t,r,i){e.forEach(o=>{t.create({key:o.key,frames:t.generateFrameNumbers(s,{frames:o.frames.map(Ie(o.row,r))}),frameRate:i,repeat:-1})})}const He=Phaser.Events.EventEmitter;var P;(s=>{var i,o,a;let e;(h=>{h[h.Up=0]="Up",h[h.Down=1]="Down",h[h.Left=2]="Left",h[h.Right=3]="Right",h[h.A=4]="A",h[h.B=5]="B",h[h.Start=6]="Start",h[h.None=7]="None"})(e=s.Buttons||(s.Buttons={}));class t extends He{constructor(){super(...arguments);c(this,i,K(V({},Me(Ce(e,()=>new r(!1,!0)),(w,j)=>Se(Number(j)))),{[7]:new r(!0,!0)}))}isPressed(w){return n(this,i)[w].isPressed()}press(w,j,Y=!0){!n(this,i)[w].isEnabled()||(n(this,i)[w].setPressed(j),Y&&this.emit("change",this))}pressMany(w,j,Y=!0){j.forEach(ee=>{!n(this,i)[ee].isEnabled()||n(this,i)[ee].setPressed(w)}),Y&&this.emit("change",this)}}i=new WeakMap,s.Gamepad=t;class r{constructor(x,w){c(this,o,void 0);c(this,a,void 0);l(this,o,x),l(this,a,w)}isPressed(){return n(this,o)}setPressed(x){l(this,o,x)}isEnabled(){return n(this,a)}}o=new WeakMap,a=new WeakMap})(P||(P={}));const Ve=P.Gamepad,y=P.Buttons;var b=(s=>(s[s.Slowest=1]="Slowest",s[s.Slow=2]="Slow",s[s.Mid=4]="Mid",s[s.Fast=5]="Fast",s))(b||{}),G,ge,U,be;class X{constructor(e,t,r,i,o,a,h,x=!1){c(this,G);c(this,U);p(this,"movementType");p(this,"movement");p(this,"gamepad");p(this,"speed");this.name=e,this.sprite=t,this.gamepad=new Ve,this.sprite.setOrigin(0,0),this.sprite.setPosition(r*u.graphics.tileWidth,i*u.graphics.tileHeight),this.sprite.setImmovable(x),this.sprite.setScale(2.5),Re(this.name,o,this.sprite.anims,a,h),this.sprite.anims.play("initial"),this.gamepad.addListener("change",L(this,G,ge),this)}update(e,t){L(this,U,be).call(this)}}G=new WeakSet,ge=function(e){e.isPressed(y.Right)?this.sprite.anims.play("right",!0):e.isPressed(y.Left)?this.sprite.anims.play("left",!0):e.isPressed(y.Up)?this.sprite.anims.play("up",!0):e.isPressed(y.Down)?this.sprite.anims.play("down",!0):this.sprite.anims.pause()},U=new WeakSet,be=function(){this.gamepad.isPressed(y.Up)?this.sprite.setVelocityY(-this.speed*30):this.gamepad.isPressed(y.Down)?this.sprite.setVelocityY(this.speed*30):this.sprite.setVelocityY(0),this.gamepad.isPressed(y.Right)?this.sprite.setVelocityX(this.speed*30):this.gamepad.isPressed(y.Left)?this.sprite.setVelocityX(-this.speed*30):this.sprite.setVelocityX(0)};const Ke=P.Buttons,We=6;var F,we;class ke extends X{constructor(t,r,i,o){const a=t.physics.add.sprite(0,0,"bomberman");super("bomberman",a,i,o,[{key:"initial",row:0,frames:[0]},{key:"up",row:1,frames:[2,1,0,1]},{key:"down",row:2,frames:[2,1,0,1]},{key:"right",row:3,frames:[2,1,0,1]},{key:"left",row:4,frames:[2,1,0,1]},{key:"death",row:5,frames:[0,1,2,3,4]}],6,We);c(this,F);this.bombs=r,this.speed=b.Mid,this.sprite.setDepth(1)}update(t,r,i,o){super.update(t,r),L(this,F,we).call(this,i,o)}}F=new WeakSet,we=function(t,r){if(this.gamepad.isPressed(Ke.A)&&!t.overlap(this.sprite,this.bombs.group)&&!t.overlap(this.sprite,r.bricks.group)){const i=this.sprite.getCenter(),{x:o,y:a}=je(i.x,i.y);this.bombs.addBomb(o,a)}};const Ge=3;class Ue extends X{constructor(e,t,r){super("bomb",e.get(),t,r,[{key:"initial",row:0,frames:[0,1,2]}],6,Ge,!0)}}class Fe{constructor(e){p(this,"group");this.group=e.physics.add.group({defaultKey:"bomb"})}addBomb(e,t){new Ue(this.group,e,t)}}const Xe=3;class Ye extends X{constructor(e,t,r){super("brick",e.get(),t,r,[{key:"initial",row:0,frames:[0]},{key:"dead",row:5,frames:[0,1,2]}],6,Xe,!0)}}class qe{constructor(e){p(this,"group");this.group=e.physics.add.group({defaultKey:"brick"})}generateRandom(e){e.randomBricks().forEach(r=>new Ye(this.group,r.x,r.y))}}const W=P.Buttons;P.Gamepad;var ve=(s=>(s[s.Low=0]="Low",s[s.Mid=1]="Mid",s[s.High=2]="High",s[s.Impossible=3]="Impossible",s))(ve||{}),$,E,f,R;class ze{constructor(e){c(this,$,void 0);c(this,E,void 0);c(this,f,[]);c(this,R,void 0);if(l(this,$,e),l(this,E,n(this,$).gamepad),n(this,$).movementType===3)throw new Error("Impossible movement type hasn't been implemented")}start(){const e=()=>{n(this,$).movementType===0?this.makeMovement(O(0,3)):this.makeMovement(O(0,1),O(2,3))};e(),l(this,R,setInterval(e,3e3))}stop(){clearInterval(n(this,R))}makeMovement(e,t){n(this,E).pressMany(!1,n(this,f),!1),l(this,f,[]),e===0?n(this,f).push(W.Left):e===1&&n(this,f).push(W.Right),e===2||t===2?n(this,f).push(W.Up):(e===3||t===3)&&n(this,f).push(W.Down),n(this,E).pressMany(!0,n(this,f))}}$=new WeakMap,E=new WeakMap,f=new WeakMap,R=new WeakMap;const Je=5;class D extends X{constructor(e,t,r,i){super(e,t,r,i,[{key:"initial",row:1,frames:[0]},{key:"up",row:1,frames:[0,1,2]},{key:"down",row:2,frames:[0,1,2]},{key:"right",row:3,frames:[0,1,2]},{key:"left",row:4,frames:[0,1,2]},{key:"death",row:5,frames:[0,1,2,3]}],5,Je),this.movement=new ze(this),this.sprite.setDepth(1),this.sprite.setBounce(1,1)}}var Qe=Object.defineProperty,Te=Object.getOwnPropertyDescriptor,Ze=(s,e,t,r)=>{for(var i=r>1?void 0:r?Te(e,t):e,o=s.length-1,a;o>=0;o--)(a=s[o])&&(i=(r?a(e,t,i):a(i))||i);return r&&i&&Qe(e,t,i),i};let oe=class extends D{constructor(s,e,t){super("balloom",s.get(),e,t),this.speed=b.Slowest,this.movementType=ve.Low,this.sprite.setDepth(1)}};oe=Ze([_({type:g.BALLOOM})],oe);var es=Object.defineProperty,ss=Object.getOwnPropertyDescriptor,ts=(s,e,t,r)=>{for(var i=r>1?void 0:r?ss(e,t):e,o=s.length-1,a;o>=0;o--)(a=s[o])&&(i=(r?a(e,t,i):a(i))||i);return r&&i&&es(e,t,i),i};let ae=class extends D{constructor(s,e,t){super("doll",s.get(),e,t),this.speed=b.Slow,this.sprite.setDepth(1)}};ae=ts([_({type:g.DOLL})],ae);var is=Object.defineProperty,rs=Object.getOwnPropertyDescriptor,os=(s,e,t,r)=>{for(var i=r>1?void 0:r?rs(e,t):e,o=s.length-1,a;o>=0;o--)(a=s[o])&&(i=(r?a(e,t,i):a(i))||i);return r&&i&&is(e,t,i),i};let ne=class extends D{constructor(s,e,t){super("kondoria",s.get(),e,t),this.speed=b.Slowest,this.sprite.setDepth(1)}};ne=os([_({type:g.KONDORIA})],ne);var as=Object.defineProperty,ns=Object.getOwnPropertyDescriptor,hs=(s,e,t,r)=>{for(var i=r>1?void 0:r?ns(e,t):e,o=s.length-1,a;o>=0;o--)(a=s[o])&&(i=(r?a(e,t,i):a(i))||i);return r&&i&&as(e,t,i),i};let he=class extends D{constructor(s,e,t){super("minvo",s.get(),e,t),this.speed=b.Mid,this.sprite.setDepth(1)}};he=hs([_({type:g.MINVO})],he);var ps=Object.defineProperty,cs=Object.getOwnPropertyDescriptor,ls=(s,e,t,r)=>{for(var i=r>1?void 0:r?cs(e,t):e,o=s.length-1,a;o>=0;o--)(a=s[o])&&(i=(r?a(e,t,i):a(i))||i);return r&&i&&ps(e,t,i),i};let pe=class extends D{constructor(s,e,t){super("oneal",s.get(),e,t),this.speed=b.Slow,this.sprite.setDepth(1)}};pe=ls([_({type:g.ONEAL})],pe);var us=Object.defineProperty,ms=Object.getOwnPropertyDescriptor,ds=(s,e,t,r)=>{for(var i=r>1?void 0:r?ms(e,t):e,o=s.length-1,a;o>=0;o--)(a=s[o])&&(i=(r?a(e,t,i):a(i))||i);return r&&i&&us(e,t,i),i};let ce=class extends D{constructor(s,e,t){super("ovapi",s.get(),e,t),this.speed=b.Slowest,this.sprite.setDepth(1)}};ce=ds([_({type:g.OVAPI})],ce);var fs=Object.defineProperty,gs=Object.getOwnPropertyDescriptor,bs=(s,e,t,r)=>{for(var i=r>1?void 0:r?gs(e,t):e,o=s.length-1,a;o>=0;o--)(a=s[o])&&(i=(r?a(e,t,i):a(i))||i);return r&&i&&fs(e,t,i),i};let le=class extends D{constructor(s,e,t){super("pass",s.get(),e,t),this.speed=b.Mid,this.sprite.setDepth(1)}};le=bs([_({type:g.PASS})],le);var ws=Object.defineProperty,vs=Object.getOwnPropertyDescriptor,ys=(s,e,t,r)=>{for(var i=r>1?void 0:r?vs(e,t):e,o=s.length-1,a;o>=0;o--)(a=s[o])&&(i=(r?a(e,t,i):a(i))||i);return r&&i&&ws(e,t,i),i};let ue=class extends D{constructor(s,e,t){super("pontan",s.get(),e,t),this.speed=b.Mid,this.sprite.setDepth(1)}};ue=ys([_({type:g.PONTAN})],ue);var H;class Os{constructor(e){c(this,H,[]);p(this,"group");this.group=e.physics.add.group({defaultKey:"brick"})}generateRandom(e){e.randomEnemies().forEach(r=>{var a;const i=Ne(r.type),o=new i(this.group,r.x,r.y);n(this,H).push(o),(a=o.movement)==null||a.start()})}update(e,t){n(this,H).forEach(r=>r.update(e,t))}}H=new WeakMap;var A,N;class Ps{constructor(e){p(this,"itemTileSetLayer");c(this,A,void 0);c(this,N,void 0);p(this,"bricks");p(this,"enemies");l(this,A,new v),l(this,N,e.make.tilemap({data:n(this,A).emptyMap,width:u.graphics.sceneWidth,height:u.graphics.sceneHeight,tileWidth:u.graphics.tileWidth,tileHeight:u.graphics.tileHeight}));const t=n(this,N).addTilesetImage("items",void 0,16,16);this.itemTileSetLayer=n(this,N).createLayer(0,t),this.bricks=new qe(e),this.enemies=new Os(e),n(this,N).setCollision(0)}reset(){this.bricks.generateRandom(n(this,A)),this.enemies.generateRandom(n(this,A))}update(e,t){this.enemies.update(e,t)}}A=new WeakMap,N=new WeakMap;const M=P.Buttons,ye={Up:M.Up,Down:M.Down,Left:M.Left,Right:M.Right,x:M.A,c:M.B,Enter:M.Start};function me(s,e){return t=>{const r=ye[e];de(r)||s.gamepad.press(r,t.isDown)}}function _s(s,e){const t=s.addKeys(Object.keys(ye).join(","),!0,!0);Object.entries(t).forEach(([r,i])=>{i.on("down",me(e,r)),i.on("up",me(e,r))})}const Q=16,T=16;class Ds extends fe.exports.Scene{constructor(){super("GameScene");p(this,"bomberman");p(this,"bombs");p(this,"tileMap")}preload(){this.load.image("items","assets/map/items.png"),this.load.spritesheet("brick","assets/map/brick.png",{frameWidth:Q,frameHeight:T}),this.load.spritesheet("bomb","assets/map/bomb.png",{frameWidth:Q,frameHeight:T}),["bomberman","balloom","doll","kondoria","minvo","oneal","ovapi","pass","pontan"].forEach(t=>this.load.spritesheet(t,`assets/players/${t}.png`,{frameWidth:Q,frameHeight:T}))}create(){this.tileMap=new Ps(this),this.tileMap.reset(),this.cameras.main.setBounds(0,0,u.graphics.sceneWidth,u.graphics.sceneHeight),this.physics.world.setBounds(0,0,u.graphics.sceneWidth,u.graphics.sceneHeight),this.bombs=new Fe(this),this.bomberman=new ke(this,this.bombs,1,1),this.physics.add.collider(this.bomberman.sprite,this.tileMap.itemTileSetLayer),this.physics.add.collider(this.bombs.group,this.tileMap.itemTileSetLayer),this.physics.add.collider(this.bombs.group,this.bombs.group),this.physics.add.collider(this.bomberman.sprite,this.bombs.group),this.physics.add.collider(this.tileMap.enemies.group,[this.bombs.group,this.tileMap.bricks.group]),this.physics.add.collider(this.tileMap.enemies.group,this.tileMap.itemTileSetLayer),this.cameras.main.startFollow(this.bomberman.sprite,!0),_s(this.input.keyboard,this.bomberman)}update(t,r){super.update(t,r),this.bomberman.update(t,r,this.physics,this.tileMap),this.tileMap.update(t,r)}}new fe.exports.Game(K(V({},Ee),{scene:[Ds]}));
